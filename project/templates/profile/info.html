{% load static %}

{% if user_profile.role == "Викладач" %}
    <div class="slots-wrapper">
        <h2 class="section-title">Кількість доступних місць</h2>
        {% if slots and slots|length > 0 %}
        <div class="slots-container">
            {% for slot in slots %}
                <div class="slot-group" 
                    data-available="{{ slot.get_available_slots|default:0 }}" 
                    data-occupied="{{ slot.occupied|default:0 }}">
                    <p class="stream-title">{{ slot.stream_id }}</p>
                    <div class="slots-display"></div>
                </div>
            {% endfor %}
        </div>
        {% else %}
            <div style="color: #888; font-style: italic;">Немає інформації.</div>
        {% endif %}
    </div>

    <div>
        <h2 class="section-title mt-4">Теми курсових робіт</h2>
        {% if themes and themes|length > 0 %}
        <ul class="themes-list">
            {% for theme in themes %}
                <li class="theme-item mb-1">
                    <a href="#">{{ theme.theme }}</a><br>
                    &emsp;{{ theme.theme_description }}
                </li>            
            {% endfor %}
        </ul>
        {% else %}
            <div style="color: #888; font-style: italic;">Немає інформації.</div>
        {% endif %}
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            console.log("DOM fully loaded and parsed.");
        
            document.querySelectorAll(".slot-group").forEach(function (slotGroup, index) {
                let availableSlots = parseInt(slotGroup.dataset.available);
                let occupiedSlots = parseInt(slotGroup.dataset.occupied);
                let slotDisplay = slotGroup.querySelector(".slots-display");
        
                console.log(`Slot Group ${index + 1}:`, { availableSlots, occupiedSlots });
        
                if (isNaN(availableSlots) || isNaN(occupiedSlots)) {
                    console.warn(`Invalid slot value for slot group ${index + 1}`);
                    return;
                }
        
                for (let i = 0; i < occupiedSlots; i++) {
                    let slotSpan = document.createElement("span");
                    slotSpan.className = "slot-dot occupied";
                    slotDisplay.appendChild(slotSpan);
                }
        
                for (let i = 0; i < availableSlots; i++) {
                    let slotSpan = document.createElement("span");
                    slotSpan.className = "slot-dot available";
                    slotDisplay.appendChild(slotSpan);
                }
            });
        });
        
    </script>
{% endif %}
